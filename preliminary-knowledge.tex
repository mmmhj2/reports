
本节主要介绍固体物理课程上学习到的各种基础知识，这些知识将用于支撑对半导体材料的性质的计算。

\subsection{代数学基本知识}

我们首先介绍几个常用的代数学定义。

\begin{definition}
    群（group）是装备有二元关系$\cdot$的非空集合$G$构成的有序二元组$(G, +)$，该二元关系满足：
    \begin{enumerate}[nosep]
        \item 结合性，即
            \begin{equation}x\cdot ( y \cdot z) = (x \cdot y) \cdot z, \; \forall x,y,z \in G\end{equation}
        \item 存在单位元，即
            \begin{equation}\exists e \in G, \text{s.t. } x \cdot e = e\cdot x = x, \; \forall x \in G\end{equation}
        \item 存在逆元，即
            \begin{equation}\forall x \in G, \exists y \in G, \text{s.t. } x \cdot y = y \cdot x = e\end{equation}
    \end{enumerate}
    若该二元关系还是可交换的，即
    \begin{equation}x \cdot y = y \cdot x, \; \forall x, y \in G\end{equation}
    那么这个群称为交换的，或阿贝尔的（abelian）。
\end{definition}

可以证明，群的单位元和每个元素的逆元都是唯一的。

\begin{definition}
    格点（lattice）是向量空间$\mathbb R^n$的有限生成阿贝尔子群（finitely-generated abelian subgroup），满足
    \begin{equation}\Lambda = \left\{ \sum_{i=1}^n a_i v_i \; \middle\vert\; a_i \in \mathbb Z \right\}\end{equation}
    其中$v_i$是向量空间$\mathbb R^n$的基底。对偶空间中的格点称为该格点的对偶格点（dual lattice），满足
    \begin{equation}\Lambda^* = \left\{ v^* \in \mathbb R^n \; \middle\vert \; v^* \cdot v \in \mathbb Z ,\, \forall v \in \Lambda \right\}\end{equation}
    数学上可认为对偶格点中的元素在对偶空间${{\mathbb{R}}^n}^*$中。
\end{definition}

不同的基底可以生成相同的格点，然而从格点还原计算基底是困难的。
但是这些基底的行列式的绝对值，即一个格点对应的面积或体积，永远是一致的。

\subsection{晶格对称性的数学表述}

晶体中所有原子的排列服从一定的规律，这种规则的排列称为晶体的晶格。
晶格的特点是具有周期性，无论具有什么样的结构，总是可以看作是由某平行六面体划出的单元沿着三条边的方向重复排列而成的。
这种重复的排列在数学上可由格点表示。

\begin{definition}
    晶体的最小周期单元称为该晶格的原胞（primitive cell），其棱张成的格点称为晶体的布拉伐格点（Bravais lattice），这一格点的基底，即原胞的棱，习惯上用$a_i$表示。
\end{definition}

若布拉伐格点已经给出，则可在其中圈出晶格的原胞。
首先，选定格点中的一点，然后将布拉伐格点中与该点相邻的点以线段相连，取连线段的垂直平分线，圈出的凸多边形即为一个原胞，这种原胞称为维格纳-赛兹原胞（Wigner–Seitz cell）。

晶体的周期性表明，晶体中任何具有物理意义的量总是满足关于晶格的平移对称性。

\begin{proposition}
    设$V: \mathbb R^{2,3} \to K$为晶格中一物理量，则
    \begin{equation}V(x) = V(x + l), \; \forall l \in \Lambda\end{equation}
    其中$\Lambda$是是晶格的布拉伐格点。
\end{proposition}

在考虑了晶胞的平移对称性后，我们还希望考虑其旋转对称性，而这在数学上通常通过群来完成。

\begin{definition}
    点群（point group）是欧几里得空间中具有共同不动点的等距变换构成的群，习惯上这一共同的不动点选取在欧几里得空间的原点处。这些群是正交群$O(n)$的子群。
\end{definition}

以二维空间为例，所有$n$次旋转，即每次转动$\frac{2\pi}{n}$角度的旋转，均可构成一个点群，这些点群表征了二维平面上的中心对称，记作$C_n$。
这些群同构于$Z_n$。

若同时考虑晶格的旋转对称性和平移对称性，则并非所有的旋转均可与平移兼容，所有这些兼容的仿射变换，即同时包括平移和旋转的变换，又构成一个群，称为空间群。

\begin{definition}
    三维空间中晶体中可能出现的仿射变换组成的群称为空间群（space group）。
    二维空间中这样的群称为壁纸群（wallpaper group）或平面群（plane group）。
\end{definition}

当同时考虑平移和旋转对称性时，能够发现，并非所有平移和旋转变换均可兼容。

\begin{theorem}
    （晶体学限制定理）
    在二维和三维的格点中，能够出现的表示旋转的点群的阶数，能且仅能是$1,2,3,4,6$其中之一。
\end{theorem}

\begin{proof}
    课上给出了一个几何的证明，此处利用变换的迹给出另一个证明。
    我们知道，矩阵的迹是相似不变的，即任意选择空间的基底，同一变换在不同基底之下的矩阵表示的迹是一致的。因此，在格点空间中，由于变换一定将整数坐标映射到整数坐标，因此一定可以选择恰当的基底，使得矩阵的迹是整数。而正交矩阵的迹与旋转角度有关：
    \begin{equation}\mathrm{tr}(O) = 1 - 2 \cos \theta \in \mathbb Z \implies \cos \theta = 0, \pm 1, \pm \frac{1}{2}.\end{equation}
    从而旋转角度仅能为
    \begin{equation}\theta = 0^\circ, 60^\circ, 90^\circ, 120^\circ, 180^\circ. \qedhere\end{equation}
\end{proof}

三维空间中的点群可分为七个大类，其中每一类均有无限个群，然而由于晶体学限制定理，可能在三维晶体中出现的仅有32种。
这三十二种点群又分为七种晶系和十四种布拉伐格点，进而产生230中空间群。
这些空间群就表示了晶体所有可能的结构。

\subsection{倒易空间}

在研究薛定谔方程时，我们通过傅里叶变换将实空间中的粒子变换到傅里叶空间中进行研究。
在晶体中，我们也可以利用傅里叶变换，在对偶空间中研究晶体的性质，这一点尤其重要，因为我们知道，电磁波的衍射与傅里叶变换有密切的关系。

\begin{definition}
    晶体的布拉伐格点的对偶格点，称为该晶体的倒易格点（Reciprocal lattice），简称倒格点。
\end{definition}

\begin{proposition}
    三维空间中倒格点的一组基底是
    \begin{equation}b_1 = \frac{a_2 \times a_3}{a_1 \cdot (a_2 \times a_3)}, b_2 = \frac{a_3 \times a_1}{a_2 \cdot (a_3 \times a_1)}, b_3 = \frac{a_1 \times a_2}{a_3 \cdot (a_1 \times a_2)},\end{equation}
    这是倒格点最常用的一组基底。这组基底满足正交性，即
    \begin{equation}a_i b_j = \delta_{ij}.\end{equation}
\end{proposition}

基底的正交性容易验证，此处给出该基底确实为对偶格点基底的证明。

\begin{proof}
    首先，显然$b_i$是线性独立的，因此其必是$\mathbb R^3$的一组基底，因此对偶格点中的所有向量均可由其表出：
    \begin{equation}v^* = h_1 b_1 + h_2 b_2 + h_3 b_3, \; \forall v^* \in \Lambda^*.\end{equation}
    仅需证明$h_i$均为整数即可。
    根据对偶格点的定义，有$v^* \cdot a_1\in \mathbb Z$，
    从而
    \begin{equation}(h_1 b_1 + h_2 b_2 + h_3 b_3) a_1 = h_1 \in \mathbb Z\end{equation}
    其他两轴同理。
    因此，$b_i$确为对偶格点的基底。
\end{proof}

在物理中，我们倾向于使用以下基底：
\begin{equation}
b_1 = \frac{\mathcolor{red}{2\pi} a_2 \times a_3}{a_1 \cdot (a_2 \times a_3)}, 
b_2 = \frac{\mathcolor{red}{2\pi} a_3 \times a_1}{a_2 \cdot (a_3 \times a_1)}, 
b_3 = \frac{\mathcolor{red}{2\pi} a_1 \times a_2}{a_3 \cdot (a_1 \times a_2)}
\end{equation}
这种表示方式不符合数学上的对偶格点的要求，但是在研究傅里叶展开时更加有用，其正交性也变为$a_i b_j = 2\pi \delta_{ij}$。

倒易空间的重要性由以下命题揭示。
\begin{proposition}
    \label{proposition:pontryagin-duality}
    若某一函数在正空间中具有周期性，即
    \begin{equation}f(r) = f(r + R), \; \forall R \in \Lambda,\end{equation}
    则其傅里叶变换在倒空间中具有相同的周期性，即
    \begin{equation}F(k) = F(k + G), \; \forall G \in \Lambda^*.\end{equation}
\end{proposition}

\begin{proof}
    考虑周期函数的傅里叶变换：
    \begin{equation}F(k) = \iiint_{V_\text{晶胞}} f(r) \exp[-ik\cdot r] \,\mathrm d V.\end{equation}
    计算$F(k + G)$：
    \begin{equation}F(k+G) = \iiint_{V_\text{晶胞}} f(r) \exp[-i(k+G)\cdot r] \, \mathrm d V.\end{equation}
    现在，根据倒空间的基底，注意到$G \cdot r \in 2 \pi \mathbb Z$，
    从而
    \begin{equation}F(k+G) = \iiint_{V_\text{晶胞}} f(r) \exp[-ik\cdot r] \exp[-2i\pi] = F(k). \qedhere\end{equation}
\end{proof}

这意味着，晶体的周期性不仅存在于实空间——即位置空间——中，也存在于傅里叶变换之后的空间——即动量空间——中。
因此，晶体的晶胞也不仅仅存在于一个看得见、摸得着的实际的空间中，也存在于动量空间中。
更进一步地，由于电磁波的衍射实际展示的是傅里叶变换后的光栅，这意味着在X射线衍射下，所有晶体展示的都是倒空间的晶格。
特别地，倒空间中的维格纳-赛兹原胞称为（第一）布里渊区。

回忆到傅里叶变换后的变量实际上是波矢$k$，而函数相当于原函数在指定波矢下波的响应，那么可以认为，晶格对波的响应也符合周期性，因此我们不必研究动量空间中所有的波矢，而只需要研究第一布里渊区内部的波矢即可。
这是后文中许多研究的基础。

在研究晶体时，我们希望有一种指明晶格中的几何特征的方法，而这可通过密勒指数实现。

\begin{definition}
    密勒指数（Miller index）$[hkl]$表示倒空间中与矢量
    \begin{equation}
        G = h b_1 + k b_2 + l b_3
    \end{equation}
    正交的平面。在正空间中，这相当于由
    \begin{equation}
        (1/h, 0, 0), \; (0, 1/k, 0), \; (0, 0, 1/l).
    \end{equation}
    三个点确定的平面。其中，若某一数为零，则取正无穷。
    习惯上约定$h,k,l$三个数是互质的整数。
\end{definition}

假设晶体在正空间中为晶格参数为$a$的立方晶系，那么由密勒指数$[hkl]$规定的两个平行的晶面之间的距离为
\begin{equation}
    d_{hkl} = \frac{a}{\sqrt{h^2 + k^2 + l^2}}.
\end{equation}
这个距离可用于衍射的判定。

\subsection{晶格动力学}
本节中我们考虑一维原子链构成的晶体中，晶体原子偏移平衡点产生的波动。
即使对一维原子链这样简单的模型，我们仍然需要考虑电子与原子核的相互影响，而这对求解过于复杂。
因此，我们使用波恩-奥本海默近似来降低求解的复杂程度。
\begin{theorem}
    绕原子核运动的电子相较于原子核的质量极低，因此可认为电子无法影响原子核的运动，从而总是可以先求解电子的薛定谔方程，然后根据电子产生的平均势能求解原子核的薛定谔方程，这一近似称为波恩-奥本海默近似（Born-Oppenheimer approximation）。
\end{theorem}

利用该近似，我们可给出一维原子链的动力学方程。
\begin{proposition}
    一维单原子链的动力学方程具有
    \begin{equation}
        \hat D A(q) = \omega_q^2 A(q)
    \end{equation}
    的形式，其中$\hat D$称为动力学矩阵，$A$是每个原子的位移组成的向量，$\omega_q$是$q$波矢下的角频率。
\end{proposition}

\begin{proof}
    设系统的势能为
    \begin{equation}
        W(u_1, \dots, u_n) = \sum_{i,j} W_{i,j} (u_i, u_j)
    \end{equation}
    在平衡点处进行泰勒展开，有
    \begin{equation}
        \begin{aligned}
            W &= \sum_{i,j=1}^n W_{i,j}(0,0) + \sum_{i,j=1}^n \frac{\partial W_{i,j}}{\partial u_i} u_i \\
            &+ \frac{1}{2} \sum_{i,j=1}^n \frac{\partial^2 W_{i,j}}{\partial u_i \partial u_j} u_i u_j + O(u^3).
        \end{aligned}
    \end{equation}
    势能的零点可任意选择，因此我们令平衡处势能为零。
    又平衡处一阶微分总是零，因此取二阶近似，可认为势能是关于位移的二次函数，即
    \begin{equation}
        W(u_1, \dots, u_n) = \sum_{i,j=1}^n V_{ij}' u_i u_j  = \sum_{i,j=1}^n V_{ij} (u_i - u_j)^2.
    \end{equation}
    利用该势能，可写出单个原子的运动方程
    \begin{equation}
        m_i \ddot u_i = - 2 \sum_{j=1}^n V_{ij}(u_i - u_j)
    \end{equation}
    带入谐波解$u_i = A_i(q) \exp[i \omega_q t]$，即可得到
    \begin{equation}
        - \omega_q^2 A_i(q) + \sum_j D_{i,j} A_j(q) = 0.
    \end{equation}
    重写为矩阵形式即可。
\end{proof}

一般认为仅有相邻的原子之间的相互作用才足够显著，其他原子则不予考虑，此时的动力学方程能够更加简单。

我们考虑较简单的一种情况，即无穷长一维双原子链的情况。

\begin{proposition}
    考虑无穷长的甲、乙两种原子组成的一维双原子链，其质量分别为$m,M$。
    平衡时，两种原子之间等间距分布，间距为$a$。
    两种原子之间的相互作用可视为弹力，等价的弹性系数为$k$，则该原子链的运动方程为
    \begin{equation}
        \left\{
            \begin{aligned}
                m \ddot u_{2n} &= k(u_{2n+1} + u_{2n-1}) - 2ku_{2n} \\
                M \ddot u_{2n+1} &= k(u_{2n+2} + u_{2n}) - 2ku_{2n+1} \\
            \end{aligned}
        \right.
    \end{equation}
    而其一组解具有行波的形式，即
    \begin{equation}
        \left\{
        \begin{aligned}
            u_{2n} &= A \exp[i(\omega_q t - \cdot 2na q)], \\
            u_{2n+1} &= B\exp[i(\omega_q t - \cdot (2n+1)a q)].
        \end{aligned}
        \right.
    \end{equation}
    这种波称为格波（lattice wave）。其中$\omega_q$满足
    \begin{equation}
        \omega_q^2 = k \frac{m+M}{mM} \left( 1 \pm \sqrt{1 - \frac{4mM}{(m+M)^2} \sin^2 ( a q)} \right).
    \end{equation}
\end{proposition}

\begin{proof}
    首先给出运动方程。题设相邻两原子之间的势能为
    \begin{equation}
        E(u_i, u_{i+1}) = \frac{1}{2} k (u_i - u_{i-1})^2,
    \end{equation}
    则对甲种原子，其运动方程为
    \begin{equation}
        m \ddot u_\text{i} = k(u_{i+1} - u_i) + k(u_{i-1} - u_i) = k(u_{i+1} + u_{i-1}) - 2ku_i.
    \end{equation}
    现在将甲种原子放置在$2n$的位置上即可，乙原子的运动方程与其大致相同。
    考虑一般的行波解
    \begin{equation}
        u = K \exp[i(\omega t - qx)],
    \end{equation}
    代入方程，得到
    \begin{equation}
        \left\{
        \begin{aligned}
            \omega_q^2 A &= \frac{2k}{m} A - \frac{k}{m}[\exp(-iaq) + \exp(i aq)] B, \\
            \omega_q^2 B &= \frac{2k}{M} B - \frac{k}{M}[\exp(-i aq) + \exp(i aq)] A.
        \end{aligned}
        \right.
    \end{equation}
    重组成矩阵形式，即
    \begin{equation}
        \omega_q^2 X = D X,
    \end{equation}
    其中
    \begin{equation}
        \begin{aligned}
            X &= \begin{pmatrix}
                A \\ B
            \end{pmatrix}, \\
            D &= k \begin{pmatrix}
                \frac{2}{m} & - \frac{\exp(-iaq) + \exp(iaq)}{m} \\
                - \frac{\exp(-i aq) + \exp(iaq)}{M} & \frac{2}{M}
            \end{pmatrix}.
        \end{aligned}
    \end{equation}
    求解该特征值问题，得到
    \begin{equation}
        \omega_q^2 = k \frac{m+M}{mM} \left( 1 \pm \sqrt{1 - \frac{4mM}{(m+M)^2} \sin^2 aq} \right).
    \end{equation}
    这就是格波的色散关系。
\end{proof}

格波具有两种色散关系。
在长波极限，即$q \to 0$时，两种色散关系分别具有机械波和电磁波类似的性质，因此这两种格波分别称为声学波和光学波，对应的色散关系称为声学支（acoustic branch）和光学支（optical branch）。

若原子链是无穷长的，那么其运动学方程的形式比较简单，但是由于有无穷多个原子而无法在实际情况下求解。
如果考虑有限长的原子链，那么链条两端的原子的运动学方程势必不同，从而求解更加困难。
为解决这一问题，我们可以使用波恩-冯·卡门边界条件。

\begin{proposition}
    晶体中对向边界处的波函数应当相同，即一维原子链可视为一根有限长的环，环的长度为$Na$，其中$N$是原子个数，$a$是两原子之间的间距。
    这种边界条件称为波恩-冯·卡门边界条件（Born-von Karman boundary condition）或循环边界条件（Cyclic boundary condition）。
\end{proposition}
利用该边界条件，我们可以给出格波的所有波矢。
\begin{proposition}
    晶体中原子偏移平衡点的位移是波矢为
    \begin{equation}q = \frac{2n\pi}{L} = \frac{2n\pi}{Na}, \; n \in \mathbb Z\end{equation}
    的波，其中$L$是材料的长度，$a$为晶格长度，$N$为材料中的晶格数。
\end{proposition}

\begin{proof}
    考虑格波的周期性，有
    \begin{equation}
        u = K \exp[i(\omega t)] = K \exp[i(\omega t - N a q)].
    \end{equation}
    从而
    \begin{equation}
        N a q \in 2 \pi \mathbb Z \implies q \in \frac{2\pi}{Na} \mathbb Z.
    \end{equation}
\end{proof}

根据上文提到的波矢的周期性关系，我们只关心第一布里渊区内的格波波矢数量，这可以很容易地计算出。
\begin{corollary}
    一维晶格中的布里渊区大小为$\frac{2\pi}{a}$，因此布里渊区中的格波波矢数量恰为材料中的晶胞数量。
\end{corollary}

晶格动力学模型的一大用处在于预测材料的比热。
\begin{proposition}
    晶格动力学模型预测，材料的体积比热为
    \begin{equation}
        C_V = \frac{1}{V} \sum_q \hbar \omega_q \frac{\partial n_q}{\partial T},
    \end{equation}
    其中
    \begin{equation}
        n_q = \frac{1}{\exp[k_B T \hbar \omega_q ] - 1}
    \end{equation}
    表示格波$q$的平均原子数。
\end{proposition}

\begin{proof}
    我们已经知道，格波的波矢是量子化的，从而其能量可由哈密顿算符表出：
    \begin{equation}
        \hat H = \sum_q (\hat N + \frac{1}{2}) \hbar \omega_q,
    \end{equation}
    其中$\hat N = \hat a^\dagger \hat a$是粒子数算符，$\hat a^\dagger$和$\hat a$分别是产生和湮灭算符，这种量子称为声子（phonons）。
    从而每个本征态的本征能量为
    \begin{equation}
        \epsilon_s = \sum_q (n_{s,q} + \frac{1}{2}) \hbar \omega_q.
    \end{equation}
    本征态可由每个振动模态下的粒子数表示，即
    \begin{equation}
        \left| \psi \right> = \left| n_1, n_2, \dots, n_N \right>.
    \end{equation}
    注意我们只考虑布里渊区中的模态。现在计算正则配分函数
    \begin{equation}
        \begin{aligned}
            Z &= \sum_s \exp \left[ -\beta \sum_q (n_{q,s} + \frac{1}{2}) \hbar \omega_q \right] \\
            &= \exp \left[-\frac{\beta}{2} \sum_q \hbar \omega_q\right] \sum_s \exp\left[-\beta \sum_q n_{q,s} \hbar \omega_q\right] \\
            &= \exp \left[-\frac{\beta}{2} \sum_q \hbar \omega_q\right] \sum_s \prod_q \exp \left[ -\beta n \hbar \omega_q \right] \\
            &= \exp \left[-\frac{\beta}{2} \sum_q \hbar \omega_q\right] \prod_q \sum_{n = 0}^{\infty} \exp \left[ -\beta n \hbar \omega_q \right] \\
            & = \exp \left[-\frac{\beta}{2} \sum_q \hbar \omega_q\right] \prod_q \frac{1}{1-\exp[-\beta\hbar\omega_q]}.
        \end{aligned}
    \end{equation}
    倒数第二步将对每个状态$s$的每个模式$q$求和变为对每个模式$q$的声子数$n$求和，最后一步则使用了幂级数展开。
    从而内能为
    \begin{equation}
        U = - \frac{\partial \ln Z}{\partial \beta} = \sum_q \left(\frac{1}{\exp[\beta\hbar\omega(q)]-1} + \frac{1}{2} \right) \hbar \omega(q).
    \end{equation}
    而单位体积的热容为
    \begin{equation}
        C_V = \frac{1}{V} \frac{\partial}{\partial T} U = \frac{1}{V} \sum_q \hbar \omega(q) \frac{\partial}{\partial T} \frac{1}{\exp[k_B T \hbar \omega_q ] - 1}.
    \end{equation}
\end{proof}

在高温下，利用幂级数展开来求近似解，可得
\begin{equation}
    C_V = \frac{1}{V} \sum_q k_B = \frac{3 N k_B}{V},
\end{equation}
其中$N$是原子个数，注意在三维空间中布里渊区中的$q$点共有$3N$个。
这与经典理论下的预测和测量结果一致。

\subsection{能带结构}
在晶格动力学中，我们几乎完全忽略了电子对晶体结构的影响。
然而，显然的是，电子对材料的性质——尤其是导电性和化学性质——具有相当重要的影响，甚至可以说决定了这些性质，因此，我们必须要将它们纳入考量。
能带论则正是用于考量电子对物质性质影响的模型。
能带论认为，固体中的电子在原子核产生的周期性势场中自由运动，而不受其他电子的影响。
这一近似的理论在许多重要领域中得到了广泛的应用。
本节主要关注一维晶体中的能带理论。

电子在周期势场中运动的特点可由布洛赫定理说明。
\begin{theorem}
    （布洛赫定理）电子在晶格产生的周期性势场中自由运动的薛定谔方程的解，可由布洛赫函数组成的基底表出。布洛赫函数是形如
    \begin{equation}
        \psi(r) = \exp[i k \cdot r] u_k(r)
    \end{equation}
    的函数，其中$u_k$具有和晶格相同的周期性，即
    \begin{equation}
        u_k(r) = u_k(r + l), \; \forall l \in \Lambda.
    \end{equation}
\end{theorem}

这个定理蕴涵了倒格点中的周期性。
如果令
\begin{equation}
    k' = k + l^*, \; l^* \in \Lambda^*
\end{equation}
则因为
\begin{equation}
    l^* \cdot l \in 2 \pi \mathbb Z, \; \forall l \in \Lambda
\end{equation}
从而不会改变原基底，即
\begin{equation}
    \psi(r) = \exp[i k \cdot r] u_k(r) = \exp[i k' \cdot r] u_{k'}(r)
\end{equation}
因此对周期势场中电子的波函数的研究可被限制在第一布里渊区之中，这是对命题~\ref{proposition:pontryagin-duality}的一种重述。

\begin{proof}
    仅对一维单种原子情况的进行证明，设晶体长度为$L = Na$，其中$a$是单个晶胞的长度。
    考虑单一电子在原子产生的周期势场$V(x)$中运动，根据波恩-奥本海默近似，我们忽略电子与原子之间的相互作用。
    利用摄动理论，我们可认为电子在平均的均匀势场$\overline V$中运动，而实际的势场可使用摄动近似，
    那么电子运动的定态薛定谔方程为：
    \begin{equation}
        - \frac{\hbar^2}{2m} \frac{\partial^2}{\partial x^2} \psi + \overline V \psi = \epsilon \psi.
    \end{equation}
    这是薛定谔方程的零阶近似，其波函数可记为$\psi^0$、本征能量为$\epsilon^0$。
    零阶波函数以及对应的本征能量容易求出，即
    \begin{equation}
        \psi^0_k (x) = \frac{1}{\sqrt L} \exp[ikx], \; \epsilon^0 = \frac{\hbar^2 k^2}{2m} + \overline V,
    \end{equation}
    其中$1/\sqrt L$是归一化系数。
    对有限长度的晶体，考虑波恩-冯·卡门边界条件，此时有$k L = k N a = 2 \pi n, n \in \mathbb Z$.
    从而$k = \frac{2\pi n}{Na}$，与格波相同。
    考虑一般的非简并态微扰的计算，本征值的一阶和二阶修正为
    \begin{equation}
        \epsilon_k^1 = \braket{k|\Delta V|k}, \; \epsilon_k^2 = \sum_{k' \neq k} \frac{\left\vert \braket{k'|\Delta V|k} \right\vert^2}{\epsilon_k^0 - \epsilon_{k'}^0},
    \end{equation}
    而波函数的一阶修正为
    \begin{equation}
        \psi^1_k = \sum_{k' \neq k} \frac{\left\vert \braket{k'|\Delta V|k} \right\vert^2}{\epsilon_k^0 - \epsilon_{k'}^0} \psi_{k'}^0,
    \end{equation}
    其中
    \begin{equation}
        \Delta V(x) = V(x) - \overline V, \; \ket{k} = \ket{\psi_k^0}.
    \end{equation}
    对一阶修正，注意到
    \begin{equation}
        \epsilon_k^1 = \braket{k|\Delta V|k} = \int |\psi_k^0|^2 V(x) \, \mathrm d x - \overline V = 0.
    \end{equation}
    对能量二阶修正与波函数一阶修正，注意到
    \begin{equation}
        \braket{k'|\Delta V(x)|k} = \braket{k'|V(x)|k} - \braket{k'|\overline V|k} = \braket{k'|V(x)|k},
    \end{equation}
    这是由于波函数具有正交性：
    \begin{equation}
        \braket{k'|k} = \int_0^L {\psi_{k'}^0}^* \psi_k^0 \, \mathrm d x = \delta_{kk'}.
    \end{equation}
    现在计算$\braket{k'|V|k}$，考虑到$V$在晶格中的周期性，有：
    \begin{equation}
        \begin{aligned}
            \braket{k'|V|k} &= \frac{1}{L} \int_0^L \exp[i(k-k')x] V(x) \, \mathrm d x \\
            &= \frac{1}{L} \sum_{n=1}^N \int_{(n-1)a}^{na} \exp[i(k-k')x] V(x) \, \mathrm d x \\
            &= \frac{1}{L} \sum_{n=1}^N e^{i(k-k')(n-1)a} \int_0^a e^{i(k-k')x} V(x) \, \mathrm d x \\
            &= \left[ \frac{1}{a} \int_0^a e^{i(k-k')x} V(x) \,\mathrm d x \right] \frac{1}{N} \sum_{n=1}^N \left[e^{i(k-k')a}\right]^{n-1}.
        \end{aligned}
    \end{equation}
    接下来分两类讨论：
    \begin{enumerate}
        \item 若$k-k' \in \frac{2\pi}{a} \mathbb Z$，令$k-k' = \frac{2\pi n}{a}$，则
        \begin{equation}
            \frac{1}{N} \sum_{n=1}^N \left[e^{i(k-k')a}\right]^{n-1} = \frac{1}{N} \sum_{n=1}^N 1 = 1.
        \end{equation}
        从而
        \begin{equation}
            \braket{k'|V|k} = \frac{1}{a} \int_0^a \exp[2\pi i \frac{n}{a} x] V(x) \, \mathrm d x = V_n.
        \end{equation}
        \item 否则，有
        \begin{equation}
            \frac{1}{N} \sum_{n=1}^N \left[e^{i(k-k')a}\right]^{n-1} = \frac{1}{N} \frac{1 - \exp[i(k-k') Na]}{1 - \exp[i(k-k')a]}.
        \end{equation}
        又$k-k' \in \frac{2\pi}{Na} \mathbb Z$，从而
        \begin{equation}
            \frac{1}{N} \sum_{n=1}^N \left[e^{i(k-k')a}\right]^{n-1} = 0 \implies \braket{k'|V|k} = 0.
        \end{equation}
    \end{enumerate}
    根据这一结果，一阶修正的波函数为
    \begin{equation}
        \begin{aligned}
            \psi_k &= \psi_k^0 + \psi_k^1 \\
            &= \frac{1}{\sqrt{L}} \exp[ikx] \left( 1 + \sum_n \frac{V_n \exp[2\pi i \frac{n}{a} x]}{\frac{\hbar^2}{2m} \left( k^2 - (k + \frac{2\pi n}{a})^2 \right)} \right) \\
            &= \exp[ikx] u_k(x)
        \end{aligned}
    \end{equation}
    不难验证$u_k(x)$对$a$的周期性，从而原命题得证。
\end{proof}

特别注意，当
\begin{equation}
    k^2 = (k + \frac{2\pi n}{a})^2 \implies k = - \frac{\pi n}{2a}
\end{equation}
时，即波矢在第一布里渊区边界上时，波函数会发散。此时注意到能量
\begin{equation}
    \epsilon_{k'}^0 = \frac{\hbar^2 k'^2}{2m} + \overline V = \frac{\hbar^2 (k + \frac{2\pi n}{a})^2}{2m} + \overline V = \epsilon_k^0
\end{equation}
这意味着有两个状态的能量一致，此时需使用简并态的摄动理论进行计算。

\begin{proposition}
    当波矢位于第一布里渊区边界附近时，电子的能量从抛物线$\frac{\hbar^2 k^2}{2m} + \overline V$中偏离，形成断开的能带。
\end{proposition}

\begin{proof}
    考虑简并态的摄动理论，求解简并态下的能量$\epsilon$等价于求解特征值问题
    \begin{equation}
        \Delta V \ket{k} = 
        \begin{pmatrix}
            \braket{k|\Delta V|k} & \braket{k|\Delta V|k'} \\
            \braket{k'|\Delta V|k} & \braket{k'|\Delta V|k'}
        \end{pmatrix} \ket{k} = \epsilon_k^1 \ket{k}
    \end{equation}
\end{proof}
